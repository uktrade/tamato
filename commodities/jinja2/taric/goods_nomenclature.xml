{% from "macros/record.xml" import standard_record %}
{% from "macros/record.xml" import base_record %}

{% call standard_record(message_counter(), sequence(), transaction_id, record) %}
    <oub:goods.nomenclature>
        <oub:goods.nomenclature.sid>{{ record.sid }}</oub:goods.nomenclature.sid>
        <oub:goods.nomenclature.item.id>{{ record.item_id }}</oub:goods.nomenclature.item.id>
        <oub:producline.suffix>{{ record.suffix }}</oub:producline.suffix>
        <oub:validity.start.date>{{ record.start_date }}</oub:validity.start.date>
        {% if record.end_date %}
        <oub:validity.end.date>{{ record.end_date }}</oub:validity.end.date>
        {% endif %}
        <oub:statistical.indicator>{{ record.statistical|int }}</oub:statistical.indicator>
    </oub:goods.nomenclature>
{% endcall %}
{% if record.origin %}
{% call base_record(message_counter(), record.origin_record_code, record.origin_subrecord_code, sequence(), transaction_id, record.update_type) %}
    <oub:goods.nomenclature.origin>
        <oub:goods.nomenclature.sid>{{ record.sid }}</oub:goods.nomenclature.sid>
        <oub:derived.goods.nomenclature.item.id>{{ record.origin.item_id }}</oub:derived.goods.nomenclature.item.id>
        <oub:derived.productline.suffix>{{ record.origin.suffix }}</oub:derived.productline.suffix>
        <oub:goods.nomenclature.item.id>{{ record.item_id }}</oub:goods.nomenclature.item.id>
        <oub:productline.suffix>{{ record.suffix }}</oub:productline.suffix>
    </oub:goods.nomenclature.origin>
{% endcall %}
{% endif %}
{% if record.succeeding_goods %}
{% for successor in record.succeeding_goods %}
{% call base_record(message_counter(), record.successor_record_code, record.successor_subrecord_code, sequence(), transaction_id, record.update_type) %}
    <oub:goods.nomenclature.successor>
        <oub:goods.nomenclature.sid>{{ record.sid }}</oub:goods.nomenclature.sid>
        <oub:absorbed.goods.nomenclature.item.id>{{ successor.item_id }}</oub:absorbed.goods.nomenclature.item.id>
        <oub:absorbed.productline.suffix>{{ successor.suffix }}</oub:absorbed.productline.suffix>
        <oub:goods.nomenclature.item.id>{{ record.item_id }}</oub:goods.nomenclature.item.id>
        <oub:productline.suffix>{{ record.suffix }}</oub:productline.suffix>
    </oub:goods.nomenclature.successor>
{% endcall %}
{% endfor %}
{% endif %}
