{% from "components/button/macro.njk" import govukButton %}
{% from "components/input/macro.njk" import govukInput %}
{% from "components/table/macro.njk" import govukTable %}

{% set table_rows = [] %}
{% for workbasket in object_list %}
  {% set workbasket_link -%}
    <a href="{{ url("workbaskets:workbasket-ui-detail", kwargs={"pk": workbasket.pk}) }}">{{ workbasket.title }}</a>
  {%- endset -%}
  {{ table_rows.append([
    {"text": workbasket.pk},
    {"html": workbasket_link},
    {"text": workbasket.reason},
    {"text": workbasket.tracked_models.count()},
    {
      "html": "<span title=\"{:%d %b %y %H:%M}\">{:%d %b %y}</span>".format(
        workbasket.created_at,
        workbasket.created_at,
      )
    },
    {
      "html": "<span title=\"{:%d %b %y %H:%M}\">{:%d %b %y}</span>".format(
        workbasket.updated_at,
        workbasket.updated_at,
      )
    },
    {"text": workbasket.get_status_display()},
  ]) or "" }}
{% endfor %}

{{ govukTable({
  "head": [
    {"text": "ID"},
    {"text": "Title"},
    {"text": "Reason"},
    {"text": "Changes count"},
    {"text": "Created"},
    {"text": "Updated*"},
    {"text": "Status"},
  ],
  "rows": table_rows
}) }}
