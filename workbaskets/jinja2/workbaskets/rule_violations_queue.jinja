{% extends "layouts/layout.jinja" %}

{% from "macros/inline_filter_links.jinja" import inline_filter_links %}
{% from "components/table/macro.njk" import govukTable %}
{% from "components/button/macro.njk" import govukButton %}

{% set list_include = "includes/measures/create-task-list.jinja"%}

{% set page_title = "Rule violations queue" %}

{% block breadcrumb %}
  {{ breadcrumbs(
      request,
      [ {"text": page_title} ],
      with_workbasket=False,
  ) }}
{% endblock %}

{% block content %}
<div class="govuk-grid-row">

  <div class="govuk-grid-column-full">
    <h1 class="govuk-heading-xl">{{ page_title }}</h1>
  </div>

  {% set table_head = [
        {"text": "Workbasket ID"},
        {"text": "Checks completed"},
        {"text": "Submitted date"},
        {"text": "Celery task ID"},
        {"text": "Status"},
      ] %}

{% set table_rows = [] %}

{% for task in current_rule_checks %}
{{ table_rows.append([
                {"text": task.workbasket_id},
                {"text": task.checks_completed},
                {"text": task.date_time_start},
                {"text": task.task_id},
                {"text": task.status},
            ]) or "" }}
{% endfor %}

  {{ govukTable({
          "head": table_head,
          "rows": table_rows
      }) }}
</div>
{% endblock %}