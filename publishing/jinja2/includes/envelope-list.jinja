{% from "components/button/macro.njk" import govukButton %}
{% from "components/input/macro.njk" import govukInput %}
{% from "components/table/macro.njk" import govukTable %}

{%- set table_rows = [] -%}
{% for envelope in object_list %}

  {%- set envelope_file_history_link -%}
    <a
      class="govuk-link"
      href="{{ url('publishing:envelope-file-history-ui-detail', kwargs={'pk': envelope.pk}) }}"
    >{{ envelope.envelope_id }}</a>
  {%- endset -%}

  {{ table_rows.append([
    {"html": envelope_file_history_link},
    {"text": envelope.packagedworkbaskets.last().workbasket.title},
    {
      "html": "<span title=\"{:%d %b %y, %H:%M}\">{:%d %b %y, %H:%M}</span>".format(
        envelope.created_at,
        envelope.created_at,
      )
    },
  ]) or "" }}

{% endfor %}

{{ govukTable({
  "head": [
    {"text": "Envelope ID"},
    {"text": "Workbasket title"},
    {"text": "Created"},
  ],
  "rows": table_rows
}) }}
