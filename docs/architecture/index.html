
<!DOCTYPE html>

<html>
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="generator" content="Docutils 0.17.1: http://docutils.sourceforge.net/" />

    <title>Architecture &#8212; TaMaTo 1.0.0 documentation</title>
    <link rel="stylesheet" type="text/css" href="../../_static/pygments.css" />
    <link rel="stylesheet" type="text/css" href="../../_static/classic.css" />
    <link rel="stylesheet" type="text/css" href="../../_static/graphviz.css" />
    
    <script data-url_root="../../" id="documentation_options" src="../../_static/documentation_options.js"></script>
    <script src="../../_static/jquery.js"></script>
    <script src="../../_static/underscore.js"></script>
    <script src="../../_static/doctools.js"></script>
    
    <link rel="index" title="Index" href="../../genindex.html" />
    <link rel="search" title="Search" href="../../search.html" />
    <link rel="next" title="The Importer" href="../importer/index.html" />
    <link rel="prev" title="Code Documentation" href="../code.html" /> 
  </head><body>
    <div class="related" role="navigation" aria-label="related navigation">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="../../genindex.html" title="General Index"
             accesskey="I">index</a></li>
        <li class="right" >
          <a href="../../py-modindex.html" title="Python Module Index"
             >modules</a> |</li>
        <li class="right" >
          <a href="../importer/index.html" title="The Importer"
             accesskey="N">next</a> |</li>
        <li class="right" >
          <a href="../code.html" title="Code Documentation"
             accesskey="P">previous</a> |</li>
        <li class="nav-item nav-item-0"><a href="../index.html">TaMaTo 1.0.0 documentation</a> &#187;</li>
          <li class="nav-item nav-item-1"><a href="../code.html" accesskey="U">Code Documentation</a> &#187;</li>
        <li class="nav-item nav-item-this"><a href="">Architecture</a></li> 
      </ul>
    </div>  

    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          <div class="body" role="main">
            
  <section id="architecture">
<h1>Architecture<a class="headerlink" href="#architecture" title="Permalink to this headline">¶</a></h1>
<p>This page describes the high-level architecture of TaMaTo. If you want to
familiarize yourself with the code base, you are in just the right place!</p>
<section id="bird-s-eye-view">
<h2>Bird’s Eye View<a class="headerlink" href="#bird-s-eye-view" title="Permalink to this headline">¶</a></h2>
<img alt="../../_images/birds-eye.svg" src="../../_images/birds-eye.svg" /><p>TaMaTo is a data storage and management system that acts as the single source of
truth for the UK customs tariff. Its role is to represent trade policy as
designed by HM Government’s policy teams in the data domain and transmit this
downstream to border systems and other third-party users. It takes data in
various formats, validates it, and outputs it in various other formats.</p>
<p>The general principle for UK tariff data is to have border services working from
this single source of tariff data as much as possible. This avoids border
service delivery teams from having to manually interpret complex tariff policy
and configure their services accordingly. In general, we are trying to maximise
data flow from the source in policy to use at the border.</p>
<p>Policy teams forming trade policy have a number of levers to use in achieving
their aims. New or updated policies will change the tariff rates and controls
that are applied, and these changes then need to be reflected in the UK tariff
stored in TaMaTo. The main “format” used to do this is the user interface being
operated by a domain-aware tariff operations manager, who interprets and applies
the policy on behalf of all downstream consumers. Future work will consider more
input interfaces, such as the ability of policy teams to control the data
directly.</p>
<p>HMRC’s Customs Declaration Services (CDS) system is a primary consumer of data
from TaMaTo. There are also a number of other consumers: the Jersey and Guernsey
border systems Caesar and GEMS, policy-makers via DIT’s Data Workspace and other
third parties via open data.</p>
</section>
<section id="concepts">
<h2>Concepts<a class="headerlink" href="#concepts" title="Permalink to this headline">¶</a></h2>
<section id="taric">
<h3>TARIC<a class="headerlink" href="#taric" title="Permalink to this headline">¶</a></h3>
<p>Most UK border systems were previously designed to take customs tariff updates
from the European Union. For this reason the tariff domain model and output
interfaces match those still used by the EU. This standard is called TARIC
(TARif Intégré Communautaire, or Integrated Tariff of the European Communities).</p>
<p>TARIC is a data exchange specification – the models, fields and formats that are
used to communicate the tariff are thus pre-specified and are difficult to
change. Primarily an XML format is used which follows a TARIC XSD.</p>
<p>TARIC was designed to communicate <em>changes</em> about the tariff – hence there are a
number of features that exist specifically to do this. Most notably, the TARIC
specification models the tariff as an ever changing <em>transaction stream</em> where
each transaction represents a change to a model to be applied.</p>
<p>The streaming nature means that the entire state of the system is decided by the
sum total of all of the transactions that have currently been applied – any
future transactions are not yet visible. This has an architectural implication
that TaMaTo must be able to read data and apply business rules as of a certain
transaction as opposed to just considering all data that is present (including
e.g. draft data). More detail on what practical difference this makes is in the
documentation on <a class="reference internal" href="../adr/0012-ordering-of-tariff-transactions.html#ordering-of-tariff-transactions"><span class="std std-ref">12. Ordering of tariff transactions</span></a>.</p>
</section>
<section id="validity-dates-as-version-control">
<h3>Validity dates as version control<a class="headerlink" href="#validity-dates-as-version-control" title="Permalink to this headline">¶</a></h3>
<p>The domain model implements a version control system that specifies which models
of the tariff are live on the border on a given day. This allows a tariff update
to be sent to border systems in advance and take effect correctly at some future
time. Most models use a pair of validity dates, implemented using the
<a class="reference internal" href="#common.models.mixins.validity.ValidityMixin" title="common.models.mixins.validity.ValidityMixin"><code class="xref py py-class docutils literal notranslate"><span class="pre">ValidityMixin</span></code></a>.</p>
<dl class="py class">
<dt class="sig sig-object py" id="common.models.mixins.validity.ValidityMixin">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">common.models.mixins.validity.</span></span><span class="sig-name descname"><span class="pre">ValidityMixin</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="o"><span class="pre">*</span></span><span class="n"><span class="pre">args</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../../_modules/common/models/mixins/validity.html#ValidityMixin"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#common.models.mixins.validity.ValidityMixin" title="Permalink to this definition">¶</a></dt>
<dd><p>The model is live after the validity start date
(<code class="xref py py-attr docutils literal notranslate"><span class="pre">valid_between.lower</span></code>) and before the validity end date
(<code class="xref py py-attr docutils literal notranslate"><span class="pre">valid_between.upper</span></code>).</p>
<p>Start and end validity dates are inclusive – meaning that the model is live
from the beginning of the start date to the end of the end date. A model
with the same start and end date is therefore live for 1 day. If the
validity end date is blank (<code class="xref py py-attr docutils literal notranslate"><span class="pre">valid_between.upper_inf</span></code>) then the model
is live indefinitely after the start date.</p>
<p>Validity dates can be modified with a new version of a model, so a model
that initially has a blank end date can be updated to subsequently add one.</p>
</dd></dl>

<p>Description models have a requirement that there must always be one live
description at any time. For this reason, descriptions do not have end dates and
only have start dates. The description is live up until the start date of the
next description record. This is implemented using the
<a class="reference internal" href="#common.models.mixins.validity.ValidityStartMixin" title="common.models.mixins.validity.ValidityStartMixin"><code class="xref py py-class docutils literal notranslate"><span class="pre">ValidityStartMixin</span></code></a>.</p>
<dl class="py class">
<dt class="sig sig-object py" id="common.models.mixins.validity.ValidityStartMixin">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">common.models.mixins.validity.</span></span><span class="sig-name descname"><span class="pre">ValidityStartMixin</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="o"><span class="pre">*</span></span><span class="n"><span class="pre">args</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../../_modules/common/models/mixins/validity.html#ValidityStartMixin"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#common.models.mixins.validity.ValidityStartMixin" title="Permalink to this definition">¶</a></dt>
<dd><p>The model is live after the <code class="xref py py-attr docutils literal notranslate"><span class="pre">validity_start</span></code> date and before the
<code class="xref py py-attr docutils literal notranslate"><span class="pre">validity_start</span></code> date of the next model in the same series.</p>
<p>This is broadly the same as the <code class="xref py py-class docutils literal notranslate"><span class="pre">ValidityMixin</span></code>
but the lack of an end date enforces that there is always one model of this
type active at any one time for a given series.</p>
<p>This validity method is used when this model tracks some time-varying
property of a related model. For example, this model may carry a description
of the related model, and the description can be updated independently of
the related model. The “series” is then defined by
<code class="xref py py-attr docutils literal notranslate"><span class="pre">identifing_fields</span></code> of the related model,
such that for each related model there can be multiple of this model, each
with their own validity period.</p>
<p>Start and end validity dates are inclusive – meaning that the model is live
from the beginning of the start date to the end of the end date. A model
with the same start and end date is therefore live for 1 day. If the
validity end date is blank then the model is live indefinitely after the
start date.</p>
</dd></dl>

</section>
<section id="tracked-models-as-version-control">
<h3>Tracked models as version control<a class="headerlink" href="#tracked-models-as-version-control" title="Permalink to this headline">¶</a></h3>
<p>The TARIC data exchange communicates about models in terms of what changes are
being made to them. Hence, it is not enough for a TARIC-aware system to just
have the latest data applied and stored – the system must also keep track of
previous versions of models and be able to describe the changes that have been
done to them.</p>
<p>Each model will exist multiple times in the database, with each row representing
a new version of that model. This is implemented using the
<a class="reference internal" href="#common.models.records.TrackedModel" title="common.models.records.TrackedModel"><code class="xref py py-class docutils literal notranslate"><span class="pre">TrackedModel</span></code></a> system.</p>
<dl class="py class">
<dt class="sig sig-object py" id="common.models.records.TrackedModel">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">common.models.records.</span></span><span class="sig-name descname"><span class="pre">TrackedModel</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">id</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">polymorphic_ctype</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">transaction</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">update_type</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">version_group</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../../_modules/common/models/records.html#TrackedModel"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#common.models.records.TrackedModel" title="Permalink to this definition">¶</a></dt>
<dd><dl class="py attribute">
<dt class="sig sig-object py" id="common.models.records.TrackedModel.identifying_fields">
<span class="sig-name descname"><span class="pre">identifying_fields</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">Iterable</span><span class="p"><span class="pre">[</span></span><span class="pre">str</span><span class="p"><span class="pre">]</span></span></em><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">('sid',)</span></em><a class="headerlink" href="#common.models.records.TrackedModel.identifying_fields" title="Permalink to this definition">¶</a></dt>
<dd><p>The fields which together form a composite unique key for each model.</p>
<p>The system ID (or SID) field is normally the unique identifier of a TARIC
model, but in places where this does not exist models can declare their own.
(Note that because mutliple versions of each model will exist this does not
actually equate to a <code class="docutils literal notranslate"><span class="pre">UNIQUE</span></code> constraint in the database.)</p>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="common.models.records.TrackedModel.record_code">
<span class="sig-name descname"><span class="pre">record_code</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">int</span></em><a class="headerlink" href="#common.models.records.TrackedModel.record_code" title="Permalink to this definition">¶</a></dt>
<dd><p>The type id of this model’s type family in the TARIC specification.</p>
<p>This number groups together a number of different models into ‘records’.
Where two models share a record code, they are conceptually expressing
different properties of the same logical model.</p>
<p>In theory each <code class="xref py py-class docutils literal notranslate"><span class="pre">Transaction</span></code> should only contain
models with a single <a class="reference internal" href="#common.models.records.TrackedModel.record_code" title="common.models.records.TrackedModel.record_code"><code class="xref py py-attr docutils literal notranslate"><span class="pre">record_code</span></code></a> (but differing
<a class="reference internal" href="#common.models.records.TrackedModel.subrecord_code" title="common.models.records.TrackedModel.subrecord_code"><code class="xref py py-attr docutils literal notranslate"><span class="pre">subrecord_code</span></code></a>.)</p>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="common.models.records.TrackedModel.subrecord_code">
<span class="sig-name descname"><span class="pre">subrecord_code</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">int</span></em><a class="headerlink" href="#common.models.records.TrackedModel.subrecord_code" title="Permalink to this definition">¶</a></dt>
<dd><p>The type id of this model in the TARIC specification. The
<a class="reference internal" href="#common.models.records.TrackedModel.subrecord_code" title="common.models.records.TrackedModel.subrecord_code"><code class="xref py py-attr docutils literal notranslate"><span class="pre">subrecord_code</span></code></a> when combined with the <a class="reference internal" href="#common.models.records.TrackedModel.record_code" title="common.models.records.TrackedModel.record_code"><code class="xref py py-attr docutils literal notranslate"><span class="pre">record_code</span></code></a> uniquely
identifies the type within the specification.</p>
<p>The subrecord code gives the intended order for models in a transaction,
with comparatively smaller subrecord codes needing to come before larger
ones.</p>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="common.models.records.TrackedModel.update_type">
<span class="sig-name descname"><span class="pre">update_type</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">common.validators.UpdateType</span></em><a class="headerlink" href="#common.models.records.TrackedModel.update_type" title="Permalink to this definition">¶</a></dt>
<dd><p>The change that was made to the model when this version of the model was
authored.</p>
<p>The first version should always have <code class="xref py py-data docutils literal notranslate"><span class="pre">CREATE</span></code>,
subsequent versions will have <code class="xref py py-data docutils literal notranslate"><span class="pre">UPDATE</span></code> and the
final version will have <code class="xref py py-data docutils literal notranslate"><span class="pre">DELETE</span></code>. Deleted
models that reappear for the same <a class="reference internal" href="#common.models.records.TrackedModel.identifying_fields" title="common.models.records.TrackedModel.identifying_fields"><code class="xref py py-attr docutils literal notranslate"><span class="pre">identifying_fields</span></code></a> will have a new
<a class="reference internal" href="#common.models.records.TrackedModel.version_group" title="common.models.records.TrackedModel.version_group"><code class="xref py py-attr docutils literal notranslate"><span class="pre">version_group</span></code></a> created.</p>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="common.models.records.TrackedModel.version_group">
<span class="sig-name descname"><span class="pre">version_group</span></span><a class="headerlink" href="#common.models.records.TrackedModel.version_group" title="Permalink to this definition">¶</a></dt>
<dd><p>Each version group contains all of the versions of the same logical model.</p>
<p>When a new version of a model is authored (e.g. to
<code class="xref py py-data docutils literal notranslate"><span class="pre">DELETE</span></code> it) a new model row is created and
added to the same version group as the existing model being changed.</p>
<p>Models are identified logically by their <a class="reference internal" href="#common.models.records.TrackedModel.identifying_fields" title="common.models.records.TrackedModel.identifying_fields"><code class="xref py py-attr docutils literal notranslate"><span class="pre">identifying_fields</span></code></a>, so
within one version group all of the models should have the same values for
these fields.</p>
</dd></dl>

</dd></dl>

<p>Note that which version of a model is the “current” one depends in general on
what transactions have been applied. Each row is pinned to a specific
transaction in order to allow working out which model is the current version as
of a certain transaction. As TaMaTo will also deal with draft data, what is
“current” is somewhat dependent on what draft data is being considered.</p>
<p>In general, the system will consider any version that has been “approved” to be
eligible to be “current”, such that the version from the most recent transaction
that is not draft is considered to be “current”.</p>
<p>There are a number of convenience methods for finding “current” models.</p>
<dl class="py class">
<dt class="sig sig-object py" id="common.models.records.TrackedModelQuerySet">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">common.models.records.</span></span><span class="sig-name descname"><span class="pre">TrackedModelQuerySet</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="o"><span class="pre">*</span></span><span class="n"><span class="pre">args</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../../_modules/common/models/records.html#TrackedModelQuerySet"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#common.models.records.TrackedModelQuerySet" title="Permalink to this definition">¶</a></dt>
<dd><dl class="py method">
<dt class="sig sig-object py" id="common.models.records.TrackedModelQuerySet.approved_up_to_transaction">
<span class="sig-name descname"><span class="pre">approved_up_to_transaction</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">transaction</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><a class="reference internal" href="#common.models.records.TrackedModelQuerySet" title="common.models.records.TrackedModelQuerySet"><span class="pre">common.models.records.TrackedModelQuerySet</span></a></span></span><a class="reference internal" href="../../_modules/common/models/records.html#TrackedModelQuerySet.approved_up_to_transaction"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#common.models.records.TrackedModelQuerySet.approved_up_to_transaction" title="Permalink to this definition">¶</a></dt>
<dd><p>Get the approved versions of the model being queried unless there exists
a version of the model in a draft state within a transaction preceding
(and including) the given transaction in the workbasket of the given
transaction.</p>
<p>The generated SQL is equivalent to:</p>
<div class="highlight-SQL notranslate"><div class="highlight"><pre><span></span>SELECT *,
       Max(t3.&quot;id&quot;) filter (
           WHERE (
               t3.&quot;transaction_id&quot; = {TRANSACTION_ID}
            OR (&quot;common_transaction&quot;.&quot;order&quot; &lt; {TRANSACTION_ORDER} AND &quot;common_transaction&quot;.&quot;workbasket_id&quot; = {WORKBASKET_ID})
            OR (&quot;workbaskets_workbasket&quot;.&quot;approver_id&quot; IS NOT NULL AND &quot;workbaskets_workbasket&quot;.&quot;status&quot; IN (APPROVED_STATUSES))
           )
       ) AS &quot;latest&quot;
  FROM &quot;common_trackedmodel&quot;
 INNER JOIN &quot;common_versiongroup&quot;
    ON &quot;common_trackedmodel&quot;.&quot;version_group_id&quot; = &quot;common_versiongroup&quot;.&quot;id&quot;
  LEFT OUTER JOIN &quot;common_trackedmodel&quot; t3
    ON &quot;common_versiongroup&quot;.&quot;id&quot; = t3.&quot;version_group_id&quot;
  LEFT OUTER JOIN &quot;common_transaction&quot;
    ON t3.&quot;transaction_id&quot; = &quot;common_transaction&quot;.&quot;id&quot;
  LEFT OUTER JOIN &quot;workbaskets_workbasket&quot;
    ON &quot;common_transaction&quot;.&quot;workbasket_id&quot; = &quot;workbaskets_workbasket&quot;.&quot;id&quot;
 WHERE NOT &quot;common_trackedmodel&quot;.&quot;update_type&quot; = 2
 GROUP BY &quot;common_trackedmodel&quot;.&quot;id&quot;
HAVING max(t3.&quot;id&quot;) filter (
           WHERE (
               t3.&quot;transaction_id&quot; = {TRANSACTION_ID}
            OR (&quot;common_transaction&quot;.&quot;order&quot; &lt; {TRANSACTION_ORDER} AND &quot;common_transaction&quot;.&quot;workbasket_id&quot; = {WORKBASKET_ID})
            OR (&quot;workbaskets_workbasket&quot;.&quot;approver_id&quot; IS NOT NULL AND &quot;workbaskets_workbasket&quot;.&quot;status&quot; IN (APPROVED_STATUSES))
           )
) = &quot;common_trackedmodel&quot;.&quot;id&quot;
</pre></div>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="common.models.records.TrackedModelQuerySet.latest_approved">
<span class="sig-name descname"><span class="pre">latest_approved</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><a class="reference internal" href="#common.models.records.TrackedModelQuerySet" title="common.models.records.TrackedModelQuerySet"><span class="pre">common.models.records.TrackedModelQuerySet</span></a></span></span><a class="reference internal" href="../../_modules/common/models/records.html#TrackedModelQuerySet.latest_approved"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#common.models.records.TrackedModelQuerySet.latest_approved" title="Permalink to this definition">¶</a></dt>
<dd><p>Get all the latest versions of the model being queried which have been
approved.</p>
<p>This will specifically fetch the most recent approved row pertaining to an object.
If a row is unapproved, or has subsequently been rejected after approval, it should
not be included in the returned QuerySet. Likewise any objects which have never been
approved (are in draft as an initial create step) should not appear in the queryset.
Any row marked as deleted will also not be fetched.</p>
<p>If done from the TrackedModel this will return the objects for all tracked models.</p>
</dd></dl>

</dd></dl>

</section>
</section>
<section id="domain-modules">
<h2>Domain Modules<a class="headerlink" href="#domain-modules" title="Permalink to this headline">¶</a></h2>
<p>The tariffs domain model is implemented across a number of <strong>domain modules</strong>,
each itself a Django App. Each module is responsible for one family of tariff
objects.</p>
<section id="module-measures">
<span id="measures"></span><h3><a class="reference internal" href="#module-measures" title="measures"><code class="xref py py-mod docutils literal notranslate"><span class="pre">measures</span></code></a><a class="headerlink" href="#module-measures" title="Permalink to this headline">¶</a></h3>
<p>Measures are the fundamental building blocks of the tariff, they link
everything together, and each piece of trade legislation that impacts the trade
of goods must be translated into one or more measures.</p>
</section>
<section id="module-commodities">
<span id="commodities"></span><h3><a class="reference internal" href="#module-commodities" title="commodities"><code class="xref py py-mod docutils literal notranslate"><span class="pre">commodities</span></code></a><a class="headerlink" href="#module-commodities" title="Permalink to this headline">¶</a></h3>
<p>Commodity codes are 10-digit codes that refer to specific products. Traders must
put these codes on their declaration forms when importing or exporting goods.</p>
<p>Nomenclature, also known as goods classification, goods nomenclature or
commodity code classification, is the name for the full list of products in the
UK Tariff.</p>
<section id="tp-803-commodity-tree-changes">
<h4>TP-803: Commodity Tree Changes<a class="headerlink" href="#tp-803-commodity-tree-changes" title="Permalink to this headline">¶</a></h4>
<p>ISSUES TO CONSIDER WHEN CHANGING THE TREE
Changes to the commodity tree have two main types of considerations:
1. Do we have a correct commodity tree after the change?</p>
<blockquote>
<div><ul class="simple">
<li><p>e.g. are all parent, child, sibling and other relations as they should be</p></li>
<li><p>the question applies for the changing commodity
as well as all commodities in its hierarchy prior and post change
(these may or may not be the same depending on the change)</p></li>
</ul>
</div></blockquote>
<ol class="arabic simple" start="2">
<li><p>Have we dealt with any side effects on any related taric records</p></li>
</ol>
<blockquote>
<div><ul class="simple">
<li><p>related records may include measures, footnote associations, etc.</p></li>
<li><p>affected records may be related to the changing commodity itself
or to any commodity in the surrounding hierarchy pre- and post-change
(e.g. business rule NIG30 might mean we need to terminate a measure)</p></li>
<li><p>side effects are incidental violations of business rules
resulting from the changes made to the commodity tree
and as such can be caught in the vast majority of cases
using existing business rule validation logic in TaMaTo</p></li>
</ul>
</div></blockquote>
<p>REQUIREMENTS FOR TACKLING THE ISSUES
B. In order to handle well commodity tree chanegs in the context of
the above two main considerations, we need to adopt a new approach that:
1. Avoids late fails in terms of firing off business rule violations</p>
<blockquote>
<div><p>or post-mortem re-evaluations of the materialized commodity hierarchy
- this is particularly relevant when making large-scale</p>
<blockquote>
<div><p>changes to the tree, e.g. in the context of HS22</p>
</div></blockquote>
</div></blockquote>
<ol class="arabic simple" start="2">
<li><p>Takes advantage of early detection of side effects by providing</p></li>
</ol>
<blockquote>
<div><p>automated decision logic for the correct remedy in each case</p>
</div></blockquote>
<p>TP-803’s BOOTSTRAPPING IMPLEMENTATION
The new approach in TP-803 satisfies the above criteria by
“bootstrapping” any pending changes to the commodity tree,
providing the ability to view “before” and “after” snapshots
of the commodity tree hierarchy pre- and post- pending changes,
detecting any potential side effects on related records,
and providing a list of pending related record changes
that need to be applied alongside the commodity changes.</p>
<p>The following constructs make the bootstrapping approach possible:
1. Commodity wrapper</p>
<blockquote>
<div><ul class="simple">
<li><p>the primary benefit of the wrapper is the ability to “fake”
changes to the wrapped underlying record for the purposes of
previewing the effects and side effects of the change.</p></li>
<li><p>one example is “masking” relations fields to avoid complications
of dealing with related meta records (e.g. indents in commodities).</p></li>
<li><p>the wrapper provides a range of “convenience” methods as additional perks</p></li>
</ul>
</div></blockquote>
<ol class="arabic simple" start="2">
<li><p>CommodityCollection</p></li>
</ol>
<blockquote>
<div><ul class="simple">
<li><p>this is just a bag of commodities
– included commodities may or may not be effective at the same point in time
– the may wrap any version of a good object</p></li>
<li><p>commodity changes are applied to this collection construct</p></li>
</ul>
</div></blockquote>
<ol class="arabic simple" start="3">
<li><p>CommodityTreeSnapshot</p></li>
</ol>
<blockquote>
<div><ul class="simple">
<li><p>a collection provides the ability to take “snapshots”</p></li>
<li><p>a snapshot is a collection of commodities that are in effect
as of a given moment, and constitute the tree hierarchy as of that moment</p></li>
<li><p>a snapshot can be taken based on one of two “clocks”, but not both:
– a calendar clock (what goods were in effect as of date x)
– a transaction clock (what goods were in effect as of transaction x)
– see the Tariff Manual for further discussion on calendar vs transaction clocks</p></li>
<li><p>a snapshot has a tree hierarchy with parent, children and sibling relations
as well as traversal-style relations such as ancestors and descendants</p></li>
</ul>
</div></blockquote>
<ol class="arabic simple" start="4">
<li><p>SnapshotDiff</p></li>
</ol>
<blockquote>
<div><ul>
<li><p>a dedicated construct for evaluating snapshot diffs</p></li>
<li><p>the key benefit of the construct is clean code</p></li>
<li><p>a diff is evaluated in terms of members of a single relation for a single commodity
– e.g. what is the difference in the siblings of commodity x</p>
<blockquote>
<div><p>between snapshot a and snapshot b?</p>
</div></blockquote>
</li>
<li><p>there are two motivations for using a snapshot diff:
– compare the “before” and “after” snapshots around a commodity change
– compare the state of the commodity tree at two different points in time</p>
<blockquote>
<div><p>(even outside the context of a commodity change)</p>
</div></blockquote>
</li>
</ul>
</div></blockquote>
<ol class="arabic simple" start="5">
<li><p>CommodityChange</p></li>
</ol>
<blockquote>
<div><ul>
<li><p>a dedicated construct for pending commodity changes</p></li>
<li><p>this construct serves as a “watchdog” for pending changes:
– it evaluates the “sanity” of a requested change</p>
<blockquote>
<div><p>(e.g. if someone requests an update to a non-existing commodity)</p>
</div></blockquote>
<dl class="simple">
<dt>– it evaluates and determines remedies for any side effects</dt><dd><p>incidental to the pending change</p>
</dd>
</dl>
</li>
</ul>
</div></blockquote>
<ol class="arabic simple" start="6">
<li><p>SideEffect</p></li>
</ol>
<blockquote>
<div><ul class="simple">
<li><p>a dedicated construct for side effects and related remedies</p></li>
<li><p>the key benefit of the construct is clean code</p></li>
</ul>
</div></blockquote>
<ol class="arabic simple" start="7">
<li><p>CommodityTreeLoader</p></li>
</ol>
<blockquote>
<div><ul class="simple">
<li><p>responsible for loading any subset of the tariff db commodity tree
into a CommodityCollection (up to a chapter level)</p></li>
<li><p>see notes on workfow below for more detail</p></li>
</ul>
</div></blockquote>
<p>TP-803 WORKFLOW
With the above in mind, the intended workflow that TP-803 envisions
(parts of which are implemented elsewhere) is the following:
1. An incoming Taric envelope is parsed selectively to isolate commodity changes</p>
<blockquote>
<div><ul class="simple">
<li><p>the initial input can in theory be anything else, e.g. a spreadsheet</p></li>
</ul>
</div></blockquote>
<ol class="arabic simple" start="2">
<li><p>The existing commodity tree in the database is loaded into a CommodityCollection</p></li>
</ol>
<blockquote>
<div><p>using the CommodityTreeLoader (chapter by chapter)</p>
</div></blockquote>
<ol class="arabic simple" start="3">
<li><p>The pending commodity changes are wrapped in CommodityChange instances</p></li>
</ol>
<blockquote>
<div><ul class="simple">
<li><p>side effects are detected at this stage</p></li>
<li><p>this involves collection updates, taking “before” and “after” snapshots,
plus probing for any related records that might be affected by the change</p></li>
<li><p>any required remedies are stored in the instance’s SideEffects list</p></li>
</ul>
</div></blockquote>
<ol class="arabic simple" start="4">
<li><p>The collection is updated with the pending changes represented by these objects</p></li>
<li><p>At this point we have everything we need in order to be able to write</p></li>
</ol>
<blockquote>
<div><p>changes to the tariff db that have the intended effect on the tree hierarchy
and remedy any side effects on any related records caught up in the change
- this is picked up by a separate handler downstream (see scope below)</p>
</div></blockquote>
<p>TP-803 SCOPE
All of the above can be viewed simply as a holding bay slash decision engine;
no action is taken until the pending changes to commodities and related records
are ultimately applied as transactions in a workbasket downstream.
This write stage is the the conern of import handlers
and is implemented as a separate feature (see TP-931).</p>
</section>
</section>
<section id="module-additional_codes">
<span id="additional-codes"></span><h3><a class="reference internal" href="#module-additional_codes" title="additional_codes"><code class="xref py py-mod docutils literal notranslate"><span class="pre">additional_codes</span></code></a><a class="headerlink" href="#module-additional_codes" title="Permalink to this headline">¶</a></h3>
<p>Additional codes are used when the 10-digit commodity code is not enough to
identify the context for the trade.</p>
<p>For example, for trade remedy purposes most additional codes identify the
companies that the trade is coming from.</p>
</section>
<section id="module-quotas">
<span id="quotas"></span><h3><a class="reference internal" href="#module-quotas" title="quotas"><code class="xref py py-mod docutils literal notranslate"><span class="pre">quotas</span></code></a><a class="headerlink" href="#module-quotas" title="Permalink to this headline">¶</a></h3>
<p>Quotas are used to control quantities of particular goods being imported.</p>
</section>
<section id="module-certificates">
<span id="certificates"></span><h3><a class="reference internal" href="#module-certificates" title="certificates"><code class="xref py py-mod docutils literal notranslate"><span class="pre">certificates</span></code></a><a class="headerlink" href="#module-certificates" title="Permalink to this headline">¶</a></h3>
<p>Certificates, licenses, and non-paper conditions are sometimes required to bring
goods through customs.</p>
<p>A certificate is not a representation of the actual document itself – the
database stores only a certificate code (4 digits) and a description of that
code.</p>
</section>
<section id="module-geo_areas">
<span id="geo-areas"></span><h3><a class="reference internal" href="#module-geo_areas" title="geo_areas"><code class="xref py py-mod docutils literal notranslate"><span class="pre">geo_areas</span></code></a><a class="headerlink" href="#module-geo_areas" title="Permalink to this headline">¶</a></h3>
<p>Geographical areas represent areas to which goods can be imported or exported.</p>
<p>All measures and quotas apply to a geographical area which may contain single or
multiple countries.</p>
</section>
<section id="module-regulations">
<span id="regulations"></span><h3><a class="reference internal" href="#module-regulations" title="regulations"><code class="xref py py-mod docutils literal notranslate"><span class="pre">regulations</span></code></a><a class="headerlink" href="#module-regulations" title="Permalink to this headline">¶</a></h3>
<p>Regulations represent peices of legislation that empower tariff measures.</p>
</section>
<section id="module-footnotes">
<span id="footnotes"></span><h3><a class="reference internal" href="#module-footnotes" title="footnotes"><code class="xref py py-mod docutils literal notranslate"><span class="pre">footnotes</span></code></a><a class="headerlink" href="#module-footnotes" title="Permalink to this headline">¶</a></h3>
<p>Footnotes are used to give more human-readable information about measures or
the use of commodity codes.</p>
</section>
</section>
<section id="inside-domain-modules">
<h2>Inside Domain Modules<a class="headerlink" href="#inside-domain-modules" title="Permalink to this headline">¶</a></h2>
<p>Each domain module has a similar layout, some of which is inherited from the
Django system. Inside each domain module, you might expect to see the following,
either as modules themselves or single files.</p>
<section id="models">
<h3><code class="docutils literal notranslate"><span class="pre">models</span></code><a class="headerlink" href="#models" title="Permalink to this headline">¶</a></h3>
<p>Classes representing domain models. With again a few exceptions, most models
correspond directly to an element in the TARIC specification. Most of these will
inherit from <a class="reference internal" href="#common.models.records.TrackedModel" title="common.models.records.TrackedModel"><code class="xref py py-class docutils literal notranslate"><span class="pre">TrackedModel</span></code></a> which represents a
model for whom history is being tracked.</p>
<p>(The main exception is
<code class="xref py py-class docutils literal notranslate"><span class="pre">GoodsNomenclatureIndentNode</span></code> which is really just a
cache of the commodity code tree stored in the database and is not updated
independently of related models.)</p>
<p>The most notable places where the database schema has diverged from the TARIC
specification is on descriptions, which have been flattened into a single model
that represents both the description and the description period on the
assumption that we will only support English as a language, and for
<a class="reference internal" href="#module-regulations" title="regulations"><code class="xref py py-mod docutils literal notranslate"><span class="pre">regulations</span></code></a>, where the UK legislative model is considerably simpler than
its European counterpart.</p>
</section>
<section id="business-rules">
<h3><code class="docutils literal notranslate"><span class="pre">business_rules</span></code><a class="headerlink" href="#business-rules" title="Permalink to this headline">¶</a></h3>
<p>Classes that implement business logic checking on models. Most of the business
rules are defined by the TARIC specification. There are also some places where
new business rules have been written either based on observation of how
downstream systems react to certain situations or through a desire to more
tightly control the function of the system.</p>
<p>Business rules from the TARIC specification are named for the business rule code
used in that spec (e.g. <a class="reference internal" href="../business_rules/measures.html#measures.business_rules.ME32" title="measures.business_rules.ME32"><code class="xref py py-class docutils literal notranslate"><span class="pre">ME32</span></code></a>) and business
rules that have been added to the system are given descriptive names. Each
business rule has a docstring that describes the rule.</p>
</section>
<section id="patterns">
<h3><code class="docutils literal notranslate"><span class="pre">patterns</span></code><a class="headerlink" href="#patterns" title="Permalink to this headline">¶</a></h3>
<p>Objects that implement an operation on the data taking into account the
high-level domain logic around how the tariff actually works. These are
responsible for providing a simple interface to create data that will pass the
more complex business rules around relationships between models and for encoding
how certain situations are handled.</p>
<p>For example, “origin quotas” are a special kind of quota that require a proof of
origin certificate, and the <code class="xref py py-class docutils literal notranslate"><span class="pre">MeasureCreationPattern</span></code>
has a specific argument to its
<code class="xref py py-meth docutils literal notranslate"><span class="pre">create()</span></code> method that will set up
the measure conditions correctly to handle this use case. There is nothing in
the business rules that specifies how origin quotas should be handled (and hence
it may change in the future), but at the moment they are always implemented in a
specific way and the pattern encodes that implementation.</p>
<p>So where the tariff works a certain way as the result of a business decision as
opposed to a constraint in the data, that decision should be implemented as a
pattern.</p>
</section>
<section id="serializers">
<h3><code class="docutils literal notranslate"><span class="pre">serializers</span></code><a class="headerlink" href="#serializers" title="Permalink to this headline">¶</a></h3>
<p>Classes that implement serialization logic. Most are derived from Django REST
Framework’s serializer base class. The serializers are mostly used to output
TARIC3 XML and for this they rely on XML templates written in the Jinja2
templating language.</p>
</section>
<section id="import-parsers-and-import-handlers">
<h3><code class="docutils literal notranslate"><span class="pre">import_parsers</span></code> and <code class="docutils literal notranslate"><span class="pre">import_handlers</span></code><a class="headerlink" href="#import-parsers-and-import-handlers" title="Permalink to this headline">¶</a></h3>
<p>These are classes that extract data from TARIC XML and process that data into
complete models with all linked dependencies respectively.</p>
<p>See the documentation on <a class="reference internal" href="../importer/index.html#the-importer"><span class="std std-ref">the importer</span></a> for a full
description.</p>
</section>
<section id="validators">
<h3><code class="docutils literal notranslate"><span class="pre">validators</span></code><a class="headerlink" href="#validators" title="Permalink to this headline">¶</a></h3>
<p>Classes that implement model-specific validation routines. These mostly
implement rules around the correct formatting of data (e.g. if the code of a
model has the correct number of digits) compared to the business rules which
check correctness of fields and relationships between models.</p>
</section>
<section id="querysets">
<h3><code class="docutils literal notranslate"><span class="pre">querysets</span></code><a class="headerlink" href="#querysets" title="Permalink to this headline">¶</a></h3>
<p>Implementations of custom Django QuerySet classes that represent complex
database queries. In some places it is desirable to more tightly control how the
system fetches it’s data – for example, to efficiently generate a new field using
aggregates.</p>
<p>The <a class="reference internal" href="#common.models.records.TrackedModelQuerySet" title="common.models.records.TrackedModelQuerySet"><code class="xref py py-class docutils literal notranslate"><span class="pre">TrackedModelQuerySet</span></code></a> is one of the most used
as it implements selecting the correct versions from the version control system.</p>
</section>
<section id="parsers">
<h3><code class="docutils literal notranslate"><span class="pre">parsers</span></code><a class="headerlink" href="#parsers" title="Permalink to this headline">¶</a></h3>
<p>Classes that implement custom parsers for use in translating from simple strings
in the user interface or spreadsheets into model objects (or sets of them).
These do not generally follow a specific implementation pattern.</p>
</section>
<section id="filters">
<h3><code class="docutils literal notranslate"><span class="pre">filters</span></code><a class="headerlink" href="#filters" title="Permalink to this headline">¶</a></h3>
<p>Django-style filter objects used by the search interfaces.</p>
</section>
<section id="views">
<h3><code class="docutils literal notranslate"><span class="pre">views</span></code><a class="headerlink" href="#views" title="Permalink to this headline">¶</a></h3>
<p>Django-style view objects used by the user interface.</p>
</section>
</section>
<section id="cross-cutting-modules">
<h2>Cross-Cutting Modules<a class="headerlink" href="#cross-cutting-modules" title="Permalink to this headline">¶</a></h2>
<p>As well as domain modules, there are also a number of modules that provide
cross-cutting concerns to the rest of the system.</p>
<section id="module-importer">
<span id="importer"></span><h3><a class="reference internal" href="#module-importer" title="importer"><code class="xref py py-mod docutils literal notranslate"><span class="pre">importer</span></code></a><a class="headerlink" href="#module-importer" title="Permalink to this headline">¶</a></h3>
<p>Implements a scalable and robust system for extracting data from TARIC XML seed
and delta files and storing them correctly in TaMaTo.</p>
<p>See the documentation on the <a class="reference internal" href="../importer/nursery.html#module-importer.nursery" title="importer.nursery"><code class="xref py py-mod docutils literal notranslate"><span class="pre">nursery</span></code></a>,
<a class="reference internal" href="../importer/handlers.html#module-importer.handlers" title="importer.handlers"><code class="xref py py-mod docutils literal notranslate"><span class="pre">handlers</span></code></a>, <a class="reference internal" href="../importer/parsers_and_namespaces.html#module-importer.parsers" title="importer.parsers"><code class="xref py py-mod docutils literal notranslate"><span class="pre">parsers</span></code></a>, <a class="reference internal" href="../importer/parsers_and_namespaces.html#module-importer.namespaces" title="importer.namespaces"><code class="xref py py-mod docutils literal notranslate"><span class="pre">namespaces</span></code></a>
and <a class="reference internal" href="../importer/taric.html#module-importer.taric" title="importer.taric"><code class="xref py py-mod docutils literal notranslate"><span class="pre">taric</span></code></a> for more information.</p>
</section>
<section id="module-exporter">
<span id="exporter"></span><h3><a class="reference internal" href="#module-exporter" title="exporter"><code class="xref py py-mod docutils literal notranslate"><span class="pre">exporter</span></code></a><a class="headerlink" href="#module-exporter" title="Permalink to this headline">¶</a></h3>
<p>Classes for exposing a number of different output data formats.</p>
<p>Most notably, the exporter module implements the correct output of the
transaction stream into TARIC XML envelopes and handles the process by which
these envelopes are marshalled to CDS.</p>
<p>This module also makes available the objects in the system as an <a class="reference external" href="https://www.w3.org/TR/activitypub/">ActivityPub</a> endpoint.</p>
<p>See the documentation on <a class="reference internal" href="../exporter/index.html#the-exporter"><span class="std std-ref">the exporter</span></a> for a full
description.</p>
</section>
<section id="module-hmrc_sdes">
<span id="hmrc-sdes"></span><h3><a class="reference internal" href="#module-hmrc_sdes" title="hmrc_sdes"><code class="xref py py-mod docutils literal notranslate"><span class="pre">hmrc_sdes</span></code></a><a class="headerlink" href="#module-hmrc_sdes" title="Permalink to this headline">¶</a></h3>
<p>Provides the ability to communicate with HMRC’s Secure Data Exchange Service
(SDES).</p>
<p>When TaMaTo wants to send tariff updates to CDS, it must first make an
<a class="reference internal" href="../exporter/celery-tasks.html#taric.models.Envelope" title="taric.models.Envelope"><code class="xref py py-class docutils literal notranslate"><span class="pre">Envelope</span></code></a> file available from an SFTP endpoint. It must
then notify SDES via an HTTPS API that a file is ready to be downloaded. This
module makes available the API client library to make the call.</p>
<p>More information about SDES is available from <a class="reference external" href="https://developer.service.hmrc.gov.uk/api-documentation/docs/api/service/secure-data-exchange-notifications/1.0">the HMRC developer hub</a>.</p>
</section>
<section id="id1">
<h3><a class="reference internal" href="#module-taric" title="taric"><code class="xref py py-mod docutils literal notranslate"><span class="pre">taric</span></code></a><a class="headerlink" href="#id1" title="Permalink to this headline">¶</a></h3>
<span class="target" id="module-taric"></span><p>Implements models used by the <a class="reference internal" href="#module-exporter" title="exporter"><code class="xref py py-mod docutils literal notranslate"><span class="pre">exporter</span></code></a> to keep track of which
envelopes the system has generated and which transactions they contained.</p>
</section>
<section id="module-workbaskets">
<span id="workbaskets"></span><h3><a class="reference internal" href="#module-workbaskets" title="workbaskets"><code class="xref py py-mod docutils literal notranslate"><span class="pre">workbaskets</span></code></a><a class="headerlink" href="#module-workbaskets" title="Permalink to this headline">¶</a></h3>
<p>Provides classes and models for tracking draft data and implements the
workflow that data must go through before publication.</p>
<dl class="py class">
<dt class="sig sig-object py" id="workbaskets.models.WorkBasket">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">workbaskets.models.</span></span><span class="sig-name descname"><span class="pre">WorkBasket</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="o"><span class="pre">*</span></span><span class="n"><span class="pre">args</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../../_modules/workbaskets/models.html#WorkBasket"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#workbaskets.models.WorkBasket" title="Permalink to this definition">¶</a></dt>
<dd><p>A WorkBasket groups tariff edits which will be applied at the same time.</p>
<p>WorkBasket status is controlled by a state machine:
See <a class="reference external" href="https://uktrade.atlassian.net/wiki/spaces/TARIFFSALPHA/pages/953581609/a.+Workbasket+workflow">https://uktrade.atlassian.net/wiki/spaces/TARIFFSALPHA/pages/953581609/a.+Workbasket+workflow</a></p>
</dd></dl>

</section>
</section>
</section>


            <div class="clearer"></div>
          </div>
        </div>
      </div>
      <div class="sphinxsidebar" role="navigation" aria-label="main navigation">
        <div class="sphinxsidebarwrapper">
  <h3><a href="../index.html">Table of Contents</a></h3>
  <ul>
<li><a class="reference internal" href="#">Architecture</a><ul>
<li><a class="reference internal" href="#bird-s-eye-view">Bird’s Eye View</a></li>
<li><a class="reference internal" href="#concepts">Concepts</a><ul>
<li><a class="reference internal" href="#taric">TARIC</a></li>
<li><a class="reference internal" href="#validity-dates-as-version-control">Validity dates as version control</a></li>
<li><a class="reference internal" href="#tracked-models-as-version-control">Tracked models as version control</a></li>
</ul>
</li>
<li><a class="reference internal" href="#domain-modules">Domain Modules</a><ul>
<li><a class="reference internal" href="#module-measures"><code class="xref py py-mod docutils literal notranslate"><span class="pre">measures</span></code></a></li>
<li><a class="reference internal" href="#module-commodities"><code class="xref py py-mod docutils literal notranslate"><span class="pre">commodities</span></code></a><ul>
<li><a class="reference internal" href="#tp-803-commodity-tree-changes">TP-803: Commodity Tree Changes</a></li>
</ul>
</li>
<li><a class="reference internal" href="#module-additional_codes"><code class="xref py py-mod docutils literal notranslate"><span class="pre">additional_codes</span></code></a></li>
<li><a class="reference internal" href="#module-quotas"><code class="xref py py-mod docutils literal notranslate"><span class="pre">quotas</span></code></a></li>
<li><a class="reference internal" href="#module-certificates"><code class="xref py py-mod docutils literal notranslate"><span class="pre">certificates</span></code></a></li>
<li><a class="reference internal" href="#module-geo_areas"><code class="xref py py-mod docutils literal notranslate"><span class="pre">geo_areas</span></code></a></li>
<li><a class="reference internal" href="#module-regulations"><code class="xref py py-mod docutils literal notranslate"><span class="pre">regulations</span></code></a></li>
<li><a class="reference internal" href="#module-footnotes"><code class="xref py py-mod docutils literal notranslate"><span class="pre">footnotes</span></code></a></li>
</ul>
</li>
<li><a class="reference internal" href="#inside-domain-modules">Inside Domain Modules</a><ul>
<li><a class="reference internal" href="#models"><code class="docutils literal notranslate"><span class="pre">models</span></code></a></li>
<li><a class="reference internal" href="#business-rules"><code class="docutils literal notranslate"><span class="pre">business_rules</span></code></a></li>
<li><a class="reference internal" href="#patterns"><code class="docutils literal notranslate"><span class="pre">patterns</span></code></a></li>
<li><a class="reference internal" href="#serializers"><code class="docutils literal notranslate"><span class="pre">serializers</span></code></a></li>
<li><a class="reference internal" href="#import-parsers-and-import-handlers"><code class="docutils literal notranslate"><span class="pre">import_parsers</span></code> and <code class="docutils literal notranslate"><span class="pre">import_handlers</span></code></a></li>
<li><a class="reference internal" href="#validators"><code class="docutils literal notranslate"><span class="pre">validators</span></code></a></li>
<li><a class="reference internal" href="#querysets"><code class="docutils literal notranslate"><span class="pre">querysets</span></code></a></li>
<li><a class="reference internal" href="#parsers"><code class="docutils literal notranslate"><span class="pre">parsers</span></code></a></li>
<li><a class="reference internal" href="#filters"><code class="docutils literal notranslate"><span class="pre">filters</span></code></a></li>
<li><a class="reference internal" href="#views"><code class="docutils literal notranslate"><span class="pre">views</span></code></a></li>
</ul>
</li>
<li><a class="reference internal" href="#cross-cutting-modules">Cross-Cutting Modules</a><ul>
<li><a class="reference internal" href="#module-importer"><code class="xref py py-mod docutils literal notranslate"><span class="pre">importer</span></code></a></li>
<li><a class="reference internal" href="#module-exporter"><code class="xref py py-mod docutils literal notranslate"><span class="pre">exporter</span></code></a></li>
<li><a class="reference internal" href="#module-hmrc_sdes"><code class="xref py py-mod docutils literal notranslate"><span class="pre">hmrc_sdes</span></code></a></li>
<li><a class="reference internal" href="#id1"><code class="xref py py-mod docutils literal notranslate"><span class="pre">taric</span></code></a></li>
<li><a class="reference internal" href="#module-workbaskets"><code class="xref py py-mod docutils literal notranslate"><span class="pre">workbaskets</span></code></a></li>
</ul>
</li>
</ul>
</li>
</ul>

  <h4>Previous topic</h4>
  <p class="topless"><a href="../code.html"
                        title="previous chapter">Code Documentation</a></p>
  <h4>Next topic</h4>
  <p class="topless"><a href="../importer/index.html"
                        title="next chapter">The Importer</a></p>
  <div role="note" aria-label="source link">
    <h3>This Page</h3>
    <ul class="this-page-menu">
      <li><a href="../../_sources/docs/architecture/index.rst.txt"
            rel="nofollow">Show Source</a></li>
    </ul>
   </div>
<div id="searchbox" style="display: none" role="search">
  <h3 id="searchlabel">Quick search</h3>
    <div class="searchformwrapper">
    <form class="search" action="../../search.html" method="get">
      <input type="text" name="q" aria-labelledby="searchlabel" autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false"/>
      <input type="submit" value="Go" />
    </form>
    </div>
</div>
<script>$('#searchbox').show(0);</script>
        </div>
      </div>
      <div class="clearer"></div>
    </div>
    <div class="related" role="navigation" aria-label="related navigation">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="../../genindex.html" title="General Index"
             >index</a></li>
        <li class="right" >
          <a href="../../py-modindex.html" title="Python Module Index"
             >modules</a> |</li>
        <li class="right" >
          <a href="../importer/index.html" title="The Importer"
             >next</a> |</li>
        <li class="right" >
          <a href="../code.html" title="Code Documentation"
             >previous</a> |</li>
        <li class="nav-item nav-item-0"><a href="../index.html">TaMaTo 1.0.0 documentation</a> &#187;</li>
          <li class="nav-item nav-item-1"><a href="../code.html" >Code Documentation</a> &#187;</li>
        <li class="nav-item nav-item-this"><a href="">Architecture</a></li> 
      </ul>
    </div>
    <div class="footer" role="contentinfo">
        &#169; Copyright 2020, DIT.
      Created using <a href="https://www.sphinx-doc.org/">Sphinx</a> 5.0.0+.
    </div>
  </body>
</html>